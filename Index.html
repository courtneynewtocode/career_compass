<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Career Compass — Student Assessment</title>

  <!-- html2pdf (for PDF export) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>

  <style>

    
    :root{
      --bg:#f6fbfb;
      --card:#ffffff;
      --accent:#0b8f8f;
      --muted:#6b6f76;
      --radius:14px;
      --glass: rgba(11,143,143,0.08);
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color:#0f1720;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:linear-gradient(180deg,var(--bg),#ffffff);
      padding:28px;
      min-height:100vh;
      display:flex;
      align-items:flex-start;
      justify-content:center;
    }
    .container{
      max-width:920px;
      width:100%;
      background:transparent;
    }
    .card{
      background:var(--card);
      border-radius:var(--radius);
      padding:22px;
      box-shadow: 0 6px 20px rgba(12,20,24,0.06);
      margin-bottom:18px;
    }
    header h1{margin:0;font-size:20px}
    .muted{color:var(--muted);font-size:14px}
    .intro-grid{display:grid;grid-template-columns:1fr auto;gap:12px;align-items:center}
    .btn{
      background:var(--accent);
      color:white;
      padding:10px 14px;
      border-radius:10px;
      border:none;
      cursor:pointer;
      font-weight:600;
    }
    .btn.secondary{
      background:transparent;color:var(--accent);border:1px solid rgba(11,143,143,0.12);
    }

    .top-clusters {
  background-color: rgba(148, 196, 148, 0.3); /* light green */
  padding: 12px;
  border-radius: 10px;
}

.low-clusters {
  background-color: rgba(171, 127, 119, 0.2); /* light red */
  padding: 12px;
  border-radius: 10px;
}
    .progress {
  height: 24px; /* increase height */
  background: rgba(11,143,143,0.08);
  border-radius: 12px;
  overflow: hidden;
  margin-top: 12px;
  position: relative; 
}

.progress > i {
  display: block;
  height: 100%;
  width: 0%;
  background: linear-gradient(90deg, var(--accent), #0ea6a6);
  transition: width 0.3s ease;
}

.progress .percent-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 14px;
  font-weight: 600;
  color: #0b8f8f;
  pointer-events: none; 
  white-space: nowrap;
}


.progress div {
  pointer-events: none;
}

    
    .progress > i{display:block;height:100%;background:linear-gradient(90deg,var(--accent),#0ea6a6); width:0%;}
    .question{margin:10px 0;padding:12px;border-radius:10px;background:var(--glass)}
    .qtext{font-weight:600;margin-bottom:8px}
    .options{display:flex;gap:10px;flex-wrap:wrap}
    label.option{
      display:flex;align-items:center;gap:8px;padding:8px 10px;border-radius:8px;background:white;border:1px solid #e7eff0;cursor:pointer;
      min-width:86px;justify-content:center;font-weight:600;
    }
    input[type="radio"]{accent-color:var(--accent)}
    .nav{display:flex;justify-content:space-between;gap:10px;margin-top:18px}
    .page-title{font-size:18px;margin-bottom:6px}
    .muted.small{font-size:13px}
    .report {
      padding:18px;border-radius:12px;background:linear-gradient(180deg,#ffffff,#fbffff);
      box-shadow:inset 0 1px 0 rgba(255,255,255,0.6);
    }
    .report h2{margin-top:0}
    .two-col{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .metric{padding:12px;border-radius:10px;background:#f8feff;border:1px solid rgba(11,143,143,0.04)}
    .small-muted{font-size:13px;color:var(--muted)}
    .footer-note{font-size:13px;color:var(--muted);margin-top:8px}
    @media (max-width:700px){
      .two-col{grid-template-columns:1fr}
      label.option{min-width:60px;padding:8px}
    }

    .option {
  flex: 1;
  padding: 12px 0;
  text-align: center;
  border-radius: 10px;
  border: 1px solid #e7eff0;
  background-color: #fff;
  cursor: pointer;
  font-weight: 600;
  transition: all 0.2s ease;
  user-select: none;
}

.option:hover {
  background: #eaf7f7;
  border-color: var(--accent);
}

.option.selected {
  background: var(--accent);
  color: #fff;
  border-color: var(--accent);
}
  </style>
</head>
<body>
  <div class="container">

    <!-- MAIN CARD -->
    <div class="card" id="app">

      <div id="page-content"></div>

    </div>

  </div>

<script>
/* ============================
   Questionnaire data (from PDF)
   ============================ */

const sections = [];

/* Intro + Demographics page handled separately */

/* Section A — Interests (6 categories x 6 questions) */
const sectionA = [
  { key: 'realistic', title: 'Realistic (Doers)', questions: [
    "I like working with my hands to build or fix things",
    "I am interested in how machines or tools work",
    "I enjoy being outdoors and active",
    "I like practical tasks more than reading or writing",
    "I enjoy sports or physical activities",
    "I like working with animals or plants"
  ]},
  { key: 'investigative', title: 'Investigative (Thinkers)', questions: [
    "I like solving puzzles or figuring out how things work",
    "I enjoy doing research or learning about new topics",
    "I like science experiments",
    "I enjoy finding solutions to problems",
    "I am curious about how things are made",
    "I like working with numbers and data"
  ]},
  { key: 'artistic', title: 'Artistic (Creators)', questions: [
    "I enjoy drawing, painting, or designing things",
    "I like writing stories, poems, or songs",
    "I enjoy music, acting, or dance",
    "I like creating new ideas or trying new ways of doing things",
    "I enjoy decorating or making things look attractive",
    "I like expressing myself in creative ways"
  ]},
  { key: 'social', title: 'Social (Helpers)', questions: [
    "I enjoy helping people with their problems",
    "I like working in teams or groups",
    "I enjoy teaching or explaining things to others",
    "I like making people feel welcome and included",
    "I enjoy listening to people’s stories",
    "I like doing things that make a difference in people’s lives"
  ]},
  { key: 'enterprising', title: 'Enterprising (Persuaders)', questions: [
    "I enjoy leading group projects",
    "I like making decisions and being in charge",
    "I enjoy selling ideas or products to others",
    "I like finding ways to make money",
    "I enjoy convincing people to try new things",
    "I like organising events or activities"
  ]},
  { key: 'conventional', title: 'Conventional (Organisers)', questions: [
    "I enjoy following a clear plan or set of instructions",
    "I like keeping things neat and organised",
    "I enjoy working with numbers, charts, or spreadsheets",
    "I like following rules and making sure others do too",
    "I enjoy filing, sorting, or organising information",
    "I like doing tasks step-by-step in the right order"
  ]}
];
sectionA.forEach(s=>sections.push({...s, group:'A'}));

/* Section B — Career Drivers (5 categories x 3 questions) */
const sectionB = [
  { key:'growth', title:'Growth', questions:[
    "Even once I am in my career, I want to learn new things.",
    "Work that is challenging and pushes me to grow every day, excites me.",
    "Career progression and promotion opportunities are important to me."
  ]},
  { key:'security', title:'Security', questions:[
    "I want a job that provides a steady and predictable income every month.",
    "I prefer a predictable career path with clear expectations and not a career that is unpredictable.",
    "Earning a high income is important to me."
  ]},
  { key:'flexibility', title:'Flexibility', questions:[
    "I want to choose where and when I work.",
    "I value variety in my tasks and projects.",
    "Work–life balance is a high priority for me."
  ]},
  { key:'recognition', title:'Recognition', questions:[
    "It's important to me that my work is recognised by others.",
    "I enjoy roles where I can take leadership or be seen as an expert.",
    "I’m motivated by achievements and awards."
  ]},
  { key:'innovation', title:'Innovation', questions:[
    "I enjoy finding new ways to solve problems.",
    "I want to work in a fast-changing, creative environment.",
    "I value freedom to experiment and test new ideas."
  ]}
];
sectionB.forEach(s=>sections.push({...s, group:'B'}));

/* Section C — Strengths & Skills (27 items) -- split into 3 pages (9 each) */
const strengths = [
  "I enjoy solving puzzles, riddles, or problems that require careful thought",
  "I can break down big problems into smaller, easier steps",
  "I like finding logical reasons for why things happen",
  "I often come up with new ideas or different ways of doing things",
  "I enjoy activities like drawing, writing, or designing",
  "I can think of unique solutions when faced with challenges",
  "I feel comfortable expressing my thoughts in front of others",
  "I can explain things clearly so that people understand me",
  "I listen carefully when others are speaking",
  "I enjoy working with tools, objects, or technology",
  "I prefer learning by doing rather than just reading or listening",
  "I like fixing or building things with my hands",
  "I enjoy taking the lead in group projects or activities",
  "I feel confident making decisions that affect others",
  "I motivate people to work together toward a goal",
  "I notice when someone is upset and try to help",
  "I enjoy supporting and encouraging my friends or classmates",
  "I care about making a positive difference in people’s lives",
  "I pay attention to small details that others might miss",
  "I double-check my work to avoid mistakes",
  "I like organizing information in a neat and accurate way",
  "I adjust quickly when plans or situations change",
  "I enjoy learning new skills, even if they are difficult at first",
  "I can stay calm and figure things out in new or unfamiliar situations",
  "I keep trying, even when tasks are difficult",
  "I don’t give up easily when I face challenges",
  "I learn from setbacks and come back stronger"
];

const strengthClusters = [
  { name: "Analytical thinking", indices: [0,1,2] },
  { name: "Creativity and innovation", indices: [3,4,5] },
  { name: "Communication skills", indices: [6,7,8] },
  { name: "Practical/Hands-on skills", indices: [9,10,11] },
  { name: "Leadership and initiative", indices: [12,13,14] },
  { name: "Empathy and helping", indices: [15,16,17] },
  { name: "Detail orientation", indices: [18,19,20] },
  { name: "Adaptability and learning agility", indices: [21,22,23] },
  { name: "Resilience and perseverance", indices: [24,25,26] },
];
for(let i=0;i<3;i++){
  const chunk = strengths.slice(i*9, (i+1)*9);
  sections.push({ key:`strengths_p${i+1}`, title:`Strengths & Skills — Part ${i+1}`, questions:chunk, group:'C' });
}

/* Section D — Growth Areas (15 items) split into 2 pages: 8 & 7 */
const growthAreas = [
  "I find it hard to stay focused for a long time",
  "I sometimes avoid subjects I find difficult",
  "I can get nervous speaking in front of others",
  "I sometimes struggle to manage my time",
  "I can find it hard to work in a team",
  "I sometimes avoid asking for help when I need it",
  "I can get distracted easily",
  "I find it hard to finish tasks I start",
  "I sometimes struggle with planning ahead",
  "I find it hard to remember spoken instructions",
  "I can get stressed when things don’t go as planned",
  "I sometimes leave things until the last minute",
  "I can get frustrated when learning something new",
  "I sometimes avoid taking the lead even when I have good ideas",
  "I can find it difficult to explain my ideas clearly"
];
sections.push({ key:'growth_1', title:'Growth Areas — Part 1', questions: growthAreas.slice(0,8), group:'D' });
sections.push({ key:'growth_2', title:'Growth Areas — Part 2', questions: growthAreas.slice(8), group:'D' });

/* ============================
   Application state
   ============================ */

let currentPage = -1; // -1 = intro/demographics; 0..n => sections; last index +1 => results
const answers = {}; // track answers as { sectionKey: [numbers...] }
const demographics = {
  studentName:'', age:'', grade:'', date:'', email:'', contact:''
};

/* Initialize answers arrays */
sections.forEach(s => {
  answers[s.key] = new Array(s.questions.length).fill(null);
});

/* ============================
   Render pages
   ============================ */

const app = document.getElementById('page-content');

function renderIntro(){
  currentPage = -1;
  app.innerHTML = `
    <div>
      <div class="page-title"><strong>Career Compass — Student Assessment</strong></div>
      <h1>Welcome to The Career Compass Assessment!</h1>
<p>
  This assessment will help you discover your <strong>interests</strong>, 
  <strong>strengths</strong>, and <strong>growth areas</strong>. 
  By understanding these key aspects of yourself, you’ll begin the journey 
  of finding your <em>True North</em> — the direction that aligns with your 
  unique potential and purpose.
</p>
<p>
  <strong>Approximate time to complete:</strong> 15 to 20 minutes<br>
  <strong>Format:</strong> Self-assessment questionnaire using a rating scale of 1–5
</p>
     
      <div style="height:10px"></div>
      <div class="two-col" style="margin-top:12px">
        <div>
          <div class="card" style="padding:16px">
            <h3 style="margin:0 0 6px 0">Instructions</h3>
            <div class="muted small">
  <p style="margin:0 0 6px 0;">Read each statement carefully. Then rate each statement using the following scale:</p>
  <ul style="margin:0 0 6px 18px; padding:0;">
    <li>1 = Strongly Disagree</li>
    <li>2 = Disagree</li>
    <li>3 = Neutral</li>
    <li>4 = Agree</li>
    <li>5 = Strongly Agree</li>
  </ul>
  <p style="margin:6px 0 0 0;">There are no right or wrong answers — be honest.</p>
</div>

            <div style="height:12px"></div>
            <div class="muted small"><strong>Navigation</strong>: Use Next and Back. You can't move forward without answering every question on the page.</div>
            <div style="height:12px"></div>
            <div class="muted small"><strong>When done</strong>: You'll see a report and can download it as a PDF.</div>
          </div>
        </div>
        <div>
          <div class="card" style="padding:12px">
            <h4 style="margin:0 0 6px 0">Student details</h4>
            <div style="display:grid;gap:8px">
              <input id="stu-name" placeholder="Student name" />
              <input id="stu-age" placeholder="Age" />
              <input id="stu-grade" placeholder="Grade" />
              <input id="stu-email" placeholder="Email address" />
              <input id="stu-contact" placeholder="Contact no." />
              <input id="stu-date" placeholder="Date (YYYY-MM-DD)" value="${new Date().toISOString().slice(0,10)}" />
            </div>
            <div style="height:12px"></div>
            <button class="btn" id="start-btn">Start Assessment</button>
          </div>
        </div>
      </div>
      <div style="height:12px"></div>
      <div class="muted small">Tip: Answer quickly and honestly — there are no right/wrong answers.</div>
    </div>
  `;
  window.scrollTo(0, 0);



  document.getElementById('start-btn').addEventListener('click', () => {
  demographics.studentName = document.getElementById('stu-name').value.trim();
  demographics.age = document.getElementById('stu-age').value.trim();
  demographics.grade = document.getElementById('stu-grade').value.trim();
  demographics.email = document.getElementById('stu-email').value.trim();
  demographics.contact = document.getElementById('stu-contact').value.trim();
  demographics.date = document.getElementById('stu-date').value.trim();

 // ✅ Validation checks before starting
if (!demographics.studentName || !demographics.age || !demographics.grade) {
  alert("Please fill in your Name, Age, and Grade before starting the assessment.");
  return;
}

// Email validation (basic pattern check)
if (demographics.email && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(demographics.email)) {
  alert("Please enter a valid email address (e.g., name@example.com).");
  return;
}

// Cell phone validation (accepts digits, optional +27 or 0 prefix, length 10–12)
if (demographics.contact && !/^(\+?\d{1,3})?0?\d{9}$/.test(demographics.contact)) {
  alert("Please enter a valid contact number (e.g., 0821234567 or +27821234567).");
  return;
}


  renderPage(0);
});

}

/* Render a question page given index in sections[] */
function renderPage(index){
  if(index < 0) return renderIntro();
  currentPage = index;
  const s = sections[index];
  const totalPages = sections.length;
  // progress percent: (index+1)/ (totalPages + 1 for results) * 100
  const percent = Math.round(((index+1)/(totalPages+1))*100);

  let html = `
  <div class="page-title">${sectionLabelForGroup(s.group)}</div>
  <div class="muted small">Answer each statement honestly (1–5 scale)</div>
  <div class="progress" style="position: relative;">
  <i style="width:${percent}%;"></i>
  <div style="position: absolute; top: 0; left: 50%; transform: translateX(-50%); font-size: 12px; font-weight: 600; color: #0b8f8f;">
    ${percent}%
  </div>
</div>

    <div style="height:12px"></div>
    <div class="rating-guide" style="background:rgba(11,143,143,0.03);padding:10px 14px;border-radius:10px;margin:8px 0 14px 0;font-size:14px">
  <strong>Rating scale:</strong> 
  <ul style="margin:6px 0 0 18px;padding:0">
    <li>1 = Strongly Disagree</li>
    <li>2 = Disagree</li>
    <li>3 = Neutral</li>
    <li>4 = Agree</li>
    <li>5 = Strongly Agree</li>
  </ul>
  <div style="margin-top:6px">There are no right or wrong answers — be honest.</div>
</div>

<div id="qs"></div>


    <div class="nav">
      <div>
        <button class="btn secondary" id="back-btn" ${index===0?'disabled':''}>Back</button>
      </div>
      <div>
        <button class="btn" id="next-btn">Next</button>
      </div>
    </div>
  `;

  app.innerHTML = html;
  window.scrollTo(0, 0);


  const qsDiv = document.getElementById('qs');

  s.questions.forEach((q, i) => {
    const currentVal = answers[s.key][i];
    const qhtml = document.createElement('div');
    qhtml.className = 'question';
    qhtml.innerHTML = `
      <div class="qtext">${i+1}. ${q}</div>
      <div class="options" data-qindex="${i}"></div>
    `;
    qsDiv.appendChild(qhtml);

    const optionsDiv = qhtml.querySelector('.options');
    for (let val = 1; val <= 5; val++) {
  const opt = document.createElement('div');
  opt.className = 'option';
  opt.textContent = val;
  if (currentVal === val) opt.classList.add('selected');
  optionsDiv.appendChild(opt);

  opt.addEventListener('click', () => {
    // Clear any previously selected option in this row
    optionsDiv.querySelectorAll('.option').forEach(o => o.classList.remove('selected'));
    // Highlight the selected one
    opt.classList.add('selected');
    // Save the answer
    answers[s.key][i] = val;
  });
}

  });

  // Next/back listeners
  document.getElementById('back-btn').addEventListener('click', ()=>{
    if(index === 0) return renderIntro();
    renderPage(index-1);
  });

  document.getElementById('next-btn').addEventListener('click', ()=>{
    // Validate: all questions answered
    const arr = answers[s.key];
    const missing = arr.findIndex(x => x === null || x === undefined);
    if(missing !== -1){
      alert('Please answer all questions on this page before continuing.');
      return;
    }
    if(index+1 < sections.length){
      renderPage(index+1);
    } else {
      renderResults();
    }
  });
}

function sectionLabelForGroup(g){
  switch(g){
    case 'A': return 'Section A — Interests (Career Clusters)';
    case 'B': return 'Section B — Career Drivers';
    case 'C': return 'Section C — Strengths & Skills';
    case 'D': return 'Section D — Growth Areas';
    default: return '';
  }
}

/* ============================
   Results & scoring
   ============================ */

function renderResults(){
  currentPage = sections.length;
  // compute totals
  const scores = { A: {}, B:{}, C: {}, D: {} };
  // Section A categories
  sectionA.forEach(cat => {
    const vals = answers[cat.key];
    const total = vals.reduce((a,b)=>a+(b||0),0);
    scores.A[cat.key] = { title: cat.title, total, count: vals.length, avg: (total/vals.length).toFixed(2) };
  });
  // Section B drivers
  sectionB.forEach(cat => {
    const vals = answers[cat.key];
    const total = vals.reduce((a,b)=>a+(b||0),0);
    scores.B[cat.key] = { title: cat.title, total, count: vals.length, avg: (total/vals.length).toFixed(2) };
  });
  // Section C strengths (we'll treat each item individually and also an overall total)
  const strengthTotals = strengths.map((_, idx) => {
    // find which page contains it
    const pageIndex = Math.floor(idx/9)+ (sections.findIndex(s=>s.key==='strengths_p1'));
    // map by searching key presence
    // simpler: gather answers across strengths by iterating sections with group C
    let val = null;
    const sKey = (() => {
      const part = Math.floor(idx/9)+1;
      return `strengths_p${part}`;
    })();
    const pos = idx % 9;
    val = answers[sKey][pos];
    return val || 0;
  });
  const strengthTotalOverall = strengthTotals.reduce((a,b)=>a+b,0);
  // make list of individual strengths scores for ranking
  const strengthRank = strengths.map((text, idx)=>({ text, score: strengthTotals[idx], index: idx }))
    .sort((a,b)=>b.score - a.score);

  scores.C.overall = { total: strengthTotalOverall, count: strengths.length, avg:(strengthTotalOverall/strengths.length).toFixed(2), rank: strengthRank };

const clusterScores = strengthClusters.map(cluster => {
  const total = cluster.indices.reduce((sum, idx) => sum + (strengthTotals[idx] || 0), 0);
  const avg = (total / cluster.indices.length).toFixed(2);
  return { name: cluster.name, total, avg };
});

// Sort clusters for ranking
const topClusters = clusterScores.slice().sort((a,b)=>b.total - a.total).slice(0,3);
const lowClusters = clusterScores.slice().sort((a,b)=>a.total - b.total).slice(0,3);
  // Section D growth areas
  const growthKeys = ['growth_1','growth_2'];
  let growthTotals = {};
  growthKeys.forEach(k=>{
    const vals = answers[k];
    const total = vals.reduce((a,b)=>a+(b||0),0);
    growthTotals[k] = { total, count: vals.length, avg:(total/vals.length).toFixed(2) };
  });
  const growthOverall = Object.values(growthTotals).reduce((a,b)=>a+b.total,0);
  scores.D.overall = { total:growthOverall, count: growthAreas.length, avg:(growthOverall/growthAreas.length).toFixed(2) };

  // Prepare top/bottom for Section A
  const aList = Object.entries(scores.A).map(([k,v])=>({key:k, ...v}));
  const topA = aList.slice().sort((x,y)=>y.total - x.total).slice(0,3);
  const lowA = aList.slice().sort((x,y)=>x.total - y.total).slice(0,3);

  // Section B top 3 and bottom 2
  const bList = Object.entries(scores.B).map(([k,v])=>({key:k,...v}));
  const topB = bList.slice().sort((x,y)=>y.total - x.total).slice(0,3);
  const lowB = bList.slice().sort((x,y)=>x.total - y.total).slice(0,2);

  // Final overall total (sum of all answers)
  const overallTotal = Object.values(answers).flat().reduce((a,b)=>(a+(b||0)),0);
  const overallCount = Object.values(answers).flat().length;
  const overallAvg = (overallTotal/overallCount).toFixed(2);

  // Build report HTML
  let html = `
  <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap">
    <div>
      <h2>Career Compass — Student Report</h2>
      <p>
        Congratulations on completing the Career Compass Assessment! The report below now provides you with a deeper understanding of your <em>True North</em> — the direction that aligns your unique potential and purpose. Please use this report as a <strong>guide</strong> in your career decision making journey. Know that your interests and potential can and most likely will change, depending on what you expose yourself to.
      </p>
      <div class="small-muted">Generated: ${demographics.date || new Date().toISOString().slice(0,10)}</div>
      </div>
      <div>
        <button class="btn" id="download-pdf">Download PDF</button>
        <button class="btn secondary" id="restart">Restart</button>
      </div>
    </div>

    <div class="report" id="report-area" style="margin-top:12px">
      <h3>Demographics</h3>
      <div class="two-col">
  <div class="metric">
    <strong>Name</strong>
    <div class="small-muted">${escapeHtml(demographics.studentName || '')}</div>
  </div>
  <div class="metric">
    <strong>Age</strong>
    <div class="small-muted">${escapeHtml(demographics.age || '')}</div>
  </div>
  <div class="metric">
    <strong>Grade</strong>
    <div class="small-muted">${escapeHtml(demographics.grade || '')}</div>
  </div>
  <div class="metric">
    <strong>Email</strong>
    <div class="small-muted">${escapeHtml(demographics.email || '')}</div>
  </div>
  <div class="metric">
    <strong>Contact</strong>
    <div class="small-muted">${escapeHtml(demographics.contact || '')}</div>
  </div>
</div>

      <h3 style="margin-top:16px">Section A : Career Clusters (Interests)</h3>
      

      <div style="display:flex;gap:12px;flex-wrap:wrap">
  <div style="flex:1" class="top-clusters">
    <h4>Dominant career clusters</h4>
    <ol>
      ${topA.map(t=>`<li>${t.title} (Total: ${t.total})</li>`).join('')}
    </ol>
  </div>
  <div style="flex:1" class="low-clusters">
    <h4>Lowest scoring career clusters</h4>
    <ol>
      ${lowA.map(t=>`<li>${t.title} (Total: ${t.total})</li>`).join('')}
    </ol>
  </div>
</div>

      <h3 style="margin-top:12px">Section B : Career Drivers</h3>
     
          <h4>Top 3 career drivers</h4>
          <ol>
            ${topB.map(t=>`<li>${t.title} (Total: ${t.total})</li>`).join('')}
          </ol>
        </div>
        <div style="flex:1">
          <h4>Bottom 2 career drivers</h4>
          <ol>
            ${lowB.map(t=>`<li>${t.title} (Total: ${t.total})</li>`).join('')}
          </ol>
        </div>
      </div>

               
      <h3 style="margin-top:12px">Section C : Strength Clusters</h3>
<div style="display:flex;gap:12px;flex-wrap:wrap">
  <div style="flex:1" class="top-clusters">
    <h4>Top 3 strength clusters</h4>
    <ol>
      ${topClusters.map(c=>`<li>${c.name} — Total: ${c.total}, Avg: ${c.avg}</li>`).join('')}
    </ol>
  </div>
  <div style="flex:1" class="low-clusters">
    <h4>Lowest 3 strength clusters</h4>
    <ol>
      ${lowClusters.map(c=>`<li>${c.name} — Total: ${c.total}, Avg: ${c.avg}</li>`).join('')}
    </ol>
  </div>
</div>
      <h3 style="margin-top:12px">Section D : Growth Areas</h3>
      <div style="margin-bottom:8px">
        <div class="metric"><strong>Overall total</strong><div class="small-muted">${scores.D.overall.total}</div></div>
      </div>

      <h3 style="margin-top:12px">Report Summary</h3>
      <table style="width:100%;border-collapse:collapse">
        <tr><td style="padding:8px;border-bottom:1px dashed #e9f6f6"><strong>Dominant career cluster (Top 1)</strong></td><td style="padding:8px;border-bottom:1px dashed #e9f6f6">${topA[0].title}</td></tr>
        <tr><td style="padding:8px;border-bottom:1px dashed #e9f6f6"><strong>Top 3 career drivers</strong></td><td style="padding:8px;border-bottom:1px dashed #e9f6f6">${topB.map(t=>t.title).join(', ')}</td></tr>
        <tr><td style="padding:8px;border-bottom:1px dashed #e9f6f6"><strong>Top strengths (sample)</strong></td><td style="padding:8px;border-bottom:1px dashed #e9f6f6">${scores.C.overall.rank.slice(0,3).map(r=>r.text).join('; ')}</td></tr>
        <tr><td style="padding:8px"><strong>Top growth areas to work on</strong></td><td style="padding:8px">See growth area scores above — focus on highest-scoring items as priority areas for development.</td></tr>
      </table>

      <div class="footer-note">Note: Strengths are shown at the individual item level. If you want the 27 strengths grouped into 9 strength clusters (as in your PDF), provide the mapping and I'll update the report to rank clusters.</div>

    </div>
  `;

  app.innerHTML = `<div class="card">${html}</div>`;
  window.scrollTo(0, 0);



  document.getElementById('download-pdf').addEventListener('click', () => {
    // export the report-area element
    const element = document.getElementById('report-area');
    const opt = {
      margin:       10,
      filename:     `${(demographics.studentName||'student').replace(/\s+/g,'_')}_career_report.pdf`,
      image:        { type: 'jpeg', quality: 0.98 },
      html2canvas:  { scale: 2, useCORS: true },
      jsPDF:        { unit: 'mm', format: 'a4', orientation: 'portrait' }
    };
    html2pdf().set(opt).from(element).save();
  });

  document.getElementById('restart').addEventListener('click', ()=>{
    // reset answers
    Object.keys(answers).forEach(k => answers[k].fill(null));
    renderIntro();
  });
}

/* Utility */
function escapeHtml(s){
  if(!s) return '';
  return s.replace(/[&<>"']/g, c=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[c]);
}

/* Kick off */
renderIntro();

</script>
</body>
</html>
